# Learning Shell

## 变量

- 局部变量
- 环境变量
- `shell` 变量

### 定义

- 命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。
- 中间不能有空格，可以使用下划线 `_`。
- 不能使用标点符号。
- 不能使用 `bash` 里的关键字（可用 `help` 命令查看保留关键字）

### 使用

- $变量名
- ${变量名}

> 花括号是可选的，加不加都行，加花括号是为了帮助解释器识别变量的边界

### 只读 `readonly`

### 删除 `unset`

### 字符串

- 变量名="字符串"
- 变量名='字符串'

#### 单引号

单引号字符串的限制：

- 单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的；
- 单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。

#### 双引号

双引号的优点：

- 双引号里可以有变量
- 双引号里可以出现转义字符 `$`/`${}`

#### 拼接

直接使用 `""`/`''`拼接，不适用 `+`，双引号可以使用转义。

#### 长度

两种方式效果相同：

- ${#字符串}
- ${#字符串[0]}

#### 提取字符串

${$字符串:n:m}

#### 查找字符首次出现位置

expr index "字符串" 查询字符串

```shell
# expr index "abcd" dcb
2
```

### 数组

数组名=(值1 值2 ... 值n)

#### 读取数组

- ${数组名[n]}，根据索引获取数组元素
- ${数组名[@]}，获取全部数组元素

#### 数组长度

- ${#数组名[0]}，数组元素个数
- ${#数组名[*]}，数组元素个数
- ${#数组名[n]}，数组第 n 个元素的长度

## 参数传递

### 向脚本传递参数

脚本内获取参数的格式为：`$n`。n 代表一个数字。

`$0` 为执行的文件名（包含文件路径）。

特殊字符：

- `$#`，传递到脚本的参数个数。
- `$*`，以一个单字符串显示所有向脚本传递的参数。
    > 如"$*"用「"」括起来的情况、以"$1 $2 … $n"的形式输出所有参数。
    >
    > 处理成一个参数
- `$$`，脚本运行的当前进程ID号。
- `$!`，后台运行的最后一个进程的ID号。
- `$@`，与$*相同，但是使用时加引号，并在引号中返回每个参数。
    > 如"$@"用「"」括起来的情况、以"$1" "$2" … "$n" 的形式输出所有参数。
    >
    > 处理成多个参数
- `$-`，显示Shell使用的当前选项，与set命令功能相同。
- `$?`，显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。
